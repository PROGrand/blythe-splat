"use strict";var e=Object.defineProperty,n=(n,t,a)=>((n,t,a)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a)(n,"symbol"!=typeof t?t+"":t,a);require("./modulepreload-polyfill.js");/* empty css          */const t=require("./gsplatjs.js"),a=require("./fullscreen.js");class i{static async init(){this.renderCanvas=document.getElementById("canvas"),this.splatRenderer=new t.Y(this.renderCanvas),this.splatScene=new t.W,this.splatCamera=new t.o,this.splatRenderer.backgroundColor=new t.E(0,0,0,0);const e=document.getElementById("splat_url").value,n=document.getElementById("progress-indicator");this.splat=await t.m.LoadAsync(e,this.splatScene,(e=>n.value=100*e)),this.originalRotation=this.splat.rotation;document.getElementById("progress-dialog").close();const a=()=>{this.splatRenderer.setSize(window.innerWidth,window.innerHeight)},i=()=>{null!=this.splat_frame_id&&cancelAnimationFrame(this.splat_frame_id),this.renderFrame(),setTimeout((()=>{this.splat_frame_id=requestAnimationFrame(i)}),100)};a(),window.addEventListener("resize",a),requestAnimationFrame(i)}static renderFrame(){this.splatRenderer.render(this.splatScene,this.splatCamera)}}n(i,"splatRenderer"),n(i,"splatScene"),n(i,"splatCamera"),n(i,"splat"),n(i,"originalRotation"),n(i,"splat_frame_id",null);let r=3,l=0,s=0,o=0,c=0;let d=[],p=-1;function u(e){console.log("pointerdown_handler",e),d.push(e),1==d.length?(l=o=e.clientX,s=c=e.clientY,function(e){switch(e.button){case 0:r=0;break;case 1:r=1;break;case 2:r=2}}(e)):3==d.length&&(l=o=(d[2].clientX+d[1].clientX+d[0].clientX)/2,s=c=(d[2].clientY+d[1].clientY+d[0].clientY)/2),g(e)}function h(e){for(let n=0;n<d.length;n++)if(e.pointerId==d[n].pointerId){d[n]=e;break}if(1==d.length)!function(e){const n=e.clientX-o,a=e.clientY-c;switch(r){case 0:i.splat.position=i.splat.position.add(new t.t(.01*n,.01*a,0)),console.log("position",i.splat.position);break;case 2:i.splat.rotation=i.originalRotation.multiply(new t.l(.005*(s-e.clientY),.005*(l-e.clientX),0,1)).normalize();break;case 1:i.splat.scale=i.splat.scale.add(new t.t(.01*-a,.01*-a,.01*-a))}o=e.clientX,c=e.clientY,i.renderFrame()}(d[0]);else if(3==d.length){const e=(d[2].clientX+d[1].clientX+d[0].clientX)/2,n=(d[2].clientY+d[1].clientY+d[0].clientY)/2;i.splat.rotation=i.originalRotation.multiply(new t.l(.005*(s-n),.005*(l-e),0,1)).normalize(),i.renderFrame()}else if(2==d.length){const e=Math.sqrt(Math.pow(d[1].clientX-d[0].clientX,2)+Math.pow(d[1].clientY-d[0].clientY,2));if(p>0){const n=.005*(e-p);i.splat.scale=i.splat.scale.add(new t.t(n,n,n))}i.renderFrame(),p=e}g(e)}function m(e){!function(e){for(let n=0;n<d.length;n++)if(d[n].pointerId==e.pointerId){d.splice(n,1);break}}(e),d.length<3&&(p=-1),0==d.length&&(i.originalRotation=i.splat.rotation,r=3),g(e)}const g=e=>{e.preventDefault(),e.stopPropagation()};(async function(){await i.init(),new a.VideoEngine(i.renderCanvas),a.FullscreenEngine.init(),i.renderCanvas.onpointerdown=u,i.renderCanvas.onpointermove=h,i.renderCanvas.onpointerup=m,i.renderCanvas.onpointercancel=m,i.renderCanvas.onpointerout=m,i.renderCanvas.onpointerleave=m,i.renderCanvas.oncontextmenu=g,i.renderCanvas.ondragover=g,i.renderCanvas.ondragenter=g,i.renderCanvas.ondragleave=g})().then();
