import"./modulepreload-polyfill.js";import{r as i,_ as r,R as h,G as H,O as K,S as g,a as O,D as M,C as V,E as b,b as F,A as S,V as X,I as x,H as B,c as I,M as C,d as Y,e as G}from"./babylonjs.js";import{V as k,F as z}from"./fullscreen.js";function U(){i("EXT_lights_image_based",!0,async t=>{const{EXT_lights_image_based:e}=await r(async()=>{const{EXT_lights_image_based:n}=await import("./babylonjs.js").then(a=>a.f);return{EXT_lights_image_based:n}},[]);return new e(t)}),i("EXT_mesh_gpu_instancing",!0,async t=>{const{EXT_mesh_gpu_instancing:e}=await r(async()=>{const{EXT_mesh_gpu_instancing:n}=await import("./babylonjs.js").then(a=>a.h);return{EXT_mesh_gpu_instancing:n}},[]);return new e(t)}),i("EXT_meshopt_compression",!0,async t=>{const{EXT_meshopt_compression:e}=await r(async()=>{const{EXT_meshopt_compression:n}=await import("./babylonjs.js").then(a=>a.i);return{EXT_meshopt_compression:n}},[]);return new e(t)}),i("EXT_texture_avif",!0,async t=>{const{EXT_texture_avif:e}=await r(async()=>{const{EXT_texture_avif:n}=await import("./babylonjs.js").then(a=>a.j);return{EXT_texture_avif:n}},[]);return new e(t)}),i("EXT_texture_webp",!0,async t=>{const{EXT_texture_webp:e}=await r(async()=>{const{EXT_texture_webp:n}=await import("./babylonjs.js").then(a=>a.k);return{EXT_texture_webp:n}},[]);return new e(t)}),i("ExtrasAsMetadata",!1,async t=>{const{ExtrasAsMetadata:e}=await r(async()=>{const{ExtrasAsMetadata:n}=await import("./babylonjs.js").then(a=>a.l);return{ExtrasAsMetadata:n}},[]);return new e(t)}),i("KHR_animation_pointer",!0,async t=>{const{KHR_animation_pointer:e}=await r(async()=>{const{KHR_animation_pointer:n}=await import("./babylonjs.js").then(a=>a.K);return{KHR_animation_pointer:n}},[]);return new e(t)}),i("KHR_draco_mesh_compression",!0,async t=>{const{KHR_draco_mesh_compression:e}=await r(async()=>{const{KHR_draco_mesh_compression:n}=await import("./babylonjs.js").then(a=>a.m);return{KHR_draco_mesh_compression:n}},[]);return new e(t)}),i("KHR_interactivity",!0,async t=>{const{KHR_interactivity:e}=await r(async()=>{const{KHR_interactivity:n}=await import("./babylonjs.js").then(a=>a.n);return{KHR_interactivity:n}},[]);return new e(t)}),i("KHR_lights_punctual",!0,async t=>{const{KHR_lights:e}=await r(async()=>{const{KHR_lights:n}=await import("./babylonjs.js").then(a=>a.o);return{KHR_lights:n}},[]);return new e(t)}),i("EXT_lights_ies",!0,async t=>{const{EXT_lights_ies:e}=await r(async()=>{const{EXT_lights_ies:n}=await import("./babylonjs.js").then(a=>a.p);return{EXT_lights_ies:n}},[]);return new e(t)}),i("KHR_materials_anisotropy",!0,async t=>{const{KHR_materials_anisotropy:e}=await r(async()=>{const{KHR_materials_anisotropy:n}=await import("./babylonjs.js").then(a=>a.q);return{KHR_materials_anisotropy:n}},[]);return new e(t)}),i("KHR_materials_clearcoat",!0,async t=>{const{KHR_materials_clearcoat:e}=await r(async()=>{const{KHR_materials_clearcoat:n}=await import("./babylonjs.js").then(a=>a.s);return{KHR_materials_clearcoat:n}},[]);return new e(t)}),i("KHR_materials_diffuse_transmission",!0,async t=>{const{KHR_materials_diffuse_transmission:e}=await r(async()=>{const{KHR_materials_diffuse_transmission:n}=await import("./babylonjs.js").then(a=>a.t);return{KHR_materials_diffuse_transmission:n}},[]);return new e(t)}),i("KHR_materials_dispersion",!0,async t=>{const{KHR_materials_dispersion:e}=await r(async()=>{const{KHR_materials_dispersion:n}=await import("./babylonjs.js").then(a=>a.u);return{KHR_materials_dispersion:n}},[]);return new e(t)}),i("KHR_materials_emissive_strength",!0,async t=>{const{KHR_materials_emissive_strength:e}=await r(async()=>{const{KHR_materials_emissive_strength:n}=await import("./babylonjs.js").then(a=>a.v);return{KHR_materials_emissive_strength:n}},[]);return new e(t)}),i("KHR_materials_ior",!0,async t=>{const{KHR_materials_ior:e}=await r(async()=>{const{KHR_materials_ior:n}=await import("./babylonjs.js").then(a=>a.w);return{KHR_materials_ior:n}},[]);return new e(t)}),i("KHR_materials_iridescence",!0,async t=>{const{KHR_materials_iridescence:e}=await r(async()=>{const{KHR_materials_iridescence:n}=await import("./babylonjs.js").then(a=>a.x);return{KHR_materials_iridescence:n}},[]);return new e(t)}),i("KHR_materials_pbrSpecularGlossiness",!0,async t=>{const{KHR_materials_pbrSpecularGlossiness:e}=await r(async()=>{const{KHR_materials_pbrSpecularGlossiness:n}=await import("./babylonjs.js").then(a=>a.y);return{KHR_materials_pbrSpecularGlossiness:n}},[]);return new e(t)}),i("KHR_materials_sheen",!0,async t=>{const{KHR_materials_sheen:e}=await r(async()=>{const{KHR_materials_sheen:n}=await import("./babylonjs.js").then(a=>a.z);return{KHR_materials_sheen:n}},[]);return new e(t)}),i("KHR_materials_specular",!0,async t=>{const{KHR_materials_specular:e}=await r(async()=>{const{KHR_materials_specular:n}=await import("./babylonjs.js").then(a=>a.B);return{KHR_materials_specular:n}},[]);return new e(t)}),i("KHR_materials_transmission",!0,async t=>{const{KHR_materials_transmission:e}=await r(async()=>{const{KHR_materials_transmission:n}=await import("./babylonjs.js").then(a=>a.F);return{KHR_materials_transmission:n}},[]);return new e(t)}),i("KHR_materials_unlit",!0,async t=>{const{KHR_materials_unlit:e}=await r(async()=>{const{KHR_materials_unlit:n}=await import("./babylonjs.js").then(a=>a.J);return{KHR_materials_unlit:n}},[]);return new e(t)}),i("KHR_materials_variants",!0,async t=>{const{KHR_materials_variants:e}=await r(async()=>{const{KHR_materials_variants:n}=await import("./babylonjs.js").then(a=>a.L);return{KHR_materials_variants:n}},[]);return new e(t)}),i("KHR_materials_volume",!0,async t=>{const{KHR_materials_volume:e}=await r(async()=>{const{KHR_materials_volume:n}=await import("./babylonjs.js").then(a=>a.N);return{KHR_materials_volume:n}},[]);return new e(t)}),i("KHR_mesh_quantization",!0,async t=>{const{KHR_mesh_quantization:e}=await r(async()=>{const{KHR_mesh_quantization:n}=await import("./babylonjs.js").then(a=>a.P);return{KHR_mesh_quantization:n}},[]);return new e(t)}),i("KHR_texture_basisu",!0,async t=>{const{KHR_texture_basisu:e}=await r(async()=>{const{KHR_texture_basisu:n}=await import("./babylonjs.js").then(a=>a.Q);return{KHR_texture_basisu:n}},[]);return new e(t)}),i("KHR_texture_transform",!0,async t=>{const{KHR_texture_transform:e}=await r(async()=>{const{KHR_texture_transform:n}=await import("./babylonjs.js").then(a=>a.T);return{KHR_texture_transform:n}},[]);return new e(t)}),i("KHR_xmp_json_ld",!0,async t=>{const{KHR_xmp_json_ld:e}=await r(async()=>{const{KHR_xmp_json_ld:n}=await import("./babylonjs.js").then(a=>a.U);return{KHR_xmp_json_ld:n}},[]);return new e(t)}),i("MSFT_audio_emitter",!0,async t=>{const{MSFT_audio_emitter:e}=await r(async()=>{const{MSFT_audio_emitter:n}=await import("./babylonjs.js").then(a=>a.W);return{MSFT_audio_emitter:n}},[]);return new e(t)}),i("MSFT_lod",!0,async t=>{const{MSFT_lod:e}=await r(async()=>{const{MSFT_lod:n}=await import("./babylonjs.js").then(a=>a.X);return{MSFT_lod:n}},[]);return new e(t)}),i("MSFT_minecraftMesh",!0,async t=>{const{MSFT_minecraftMesh:e}=await r(async()=>{const{MSFT_minecraftMesh:n}=await import("./babylonjs.js").then(a=>a.Y);return{MSFT_minecraftMesh:n}},[]);return new e(t)}),i("MSFT_sRGBFactors",!0,async t=>{const{MSFT_sRGBFactors:e}=await r(async()=>{const{MSFT_sRGBFactors:n}=await import("./babylonjs.js").then(a=>a.Z);return{MSFT_sRGBFactors:n}},[]);return new e(t)}),i("KHR_node_visibility",!0,async t=>{const{KHR_node_visibility:e}=await r(async()=>{const{KHR_node_visibility:n}=await import("./babylonjs.js").then(a=>a.$);return{KHR_node_visibility:n}},[]);return new e(t)}),i("KHR_node_hoverability",!0,async t=>{const{KHR_node_hoverability:e}=await r(async()=>{const{KHR_node_hoverability:n}=await import("./babylonjs.js").then(a=>a.a0);return{KHR_node_hoverability:n}},[]);return new e(t)}),i("KHR_node_selectability",!0,async t=>{const{KHR_node_selectability:e}=await r(async()=>{const{KHR_node_selectability:n}=await import("./babylonjs.js").then(a=>a.a1);return{KHR_node_selectability:n}},[]);return new e(t)})}function q(){h({...H,createPlugin:async t=>{const{GLTFFileLoader:e}=await r(async()=>{const{GLTFFileLoader:n}=await import("./babylonjs.js").then(a=>a.g);return{GLTFFileLoader:n}},[]);return new e(t[H.name])}}),U(),h({...K,createPlugin:async t=>{const{OBJFileLoader:e}=await r(async()=>{const{OBJFileLoader:n}=await import("./babylonjs.js").then(a=>a.a2);return{OBJFileLoader:n}},[]);return new e(t[K.name])}}),h({...g,createPlugin:async t=>{const{SPLATFileLoader:e}=await r(async()=>{const{SPLATFileLoader:n}=await import("./babylonjs.js").then(a=>a.a3);return{SPLATFileLoader:n}},[]);return new e(t[g.name])}}),h({...O,createPlugin:async()=>{const{STLFileLoader:t}=await r(async()=>{const{STLFileLoader:e}=await import("./babylonjs.js").then(n=>n.a4);return{STLFileLoader:e}},[]);return new t}})}q();let v=null,p=null;const c=document.getElementById("renderCanvas");let o=null,l=null,m=null,_,T=null;function f(){o==null||o.stopRenderLoop(),T!=null&&cancelAnimationFrame(T),T=requestAnimationFrame(()=>{m!=null&&m.activeCamera&&m.render(!1,!0)})}const j=new M(c,"Loading","black"),P=()=>new b(c,!1,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1});function J(){m!=null&&m.activeCamera&&m.render(!1,!0)}async function N(t,e,n){t.render(!1,!0),c.toBlob(a=>{const u=document.createElement("a");u.href=URL.createObjectURL(a),u.download="splat.png",u.click(),console.log("Success! Saved cropped splat as splat.png")},"image/png",1)}let L;const W=function(){const t=new F(o),e=new S("Camera",-Math.PI/2,Math.PI/2,10,new X(0,0,0),t);e.useFramingBehavior=!0,x(document.getElementById("splat_url").value,t).then(a=>{_=a.meshes[0],o==null||o.hideLoadingUI(),_.position.set(0,0,-3),_.scaling.set(1,1,1),_.rotation.set(0,0,0),p=new B("vt",v==null?void 0:v.videoCanvas,{scene:t,engine:o,samplingMode:I.TEXTURE_BILINEAR_SAMPLINGMODE,generateMipMaps:!1}),window.setInterval(()=>{p==null||p.update(),t.render()},50),L=C.CreatePlane("plane",{width:1,height:1},t),L.billboardMode=Y.BILLBOARDMODE_ALL;const u=new G("RTT material",t);u.transparencyMode=3,u.alphaMode=I.ALPHA_COMBINE,u.emissiveTexture=p,u.disableLighting=!0,L.material=u,A(),o==null||o.runRenderLoop(J)});const n=document.getElementById("screenshotBtn");return n!=null&&n.addEventListener("click",async()=>{_&&await N(t)}),t.onDispose=function(){c.onpointerdown=null,c.onpointermove=null,c.onpointerup=null,c.onpointercancel=null,c.onpointerout=null,c.onpointerleave=null},at(),t};function A(){const t=m==null?void 0:m.activeCamera,e=t.fov,n=o.getAspectRatio(t),u=2*t.position.length()*Math.tan(e/2),D=u*n;L.scaling.set(D,u,1)}let w=3,R=0,E=0;function Q(){const t=l.pointerX-R,e=l.pointerY-E;switch(w){case 0:_.position.x-=-t*.01,_.position.y-=e*.01;break;case 2:_.rotation.y-=t*.01,_.rotation.x-=e*.01;break;case 1:_.scaling.y-=e*.01,_.scaling.x-=e*.01,_.scaling.z-=e*.01;break}R=l.pointerX,E=l.pointerY,f()}function Z(t){switch(R=l.pointerX,E=l.pointerY,t.button){case 0:w=0;break;case 1:w=1;break;case 2:w=2;break}}function $(){w=3}let s=[],d=-1;function tt(t){s.push(t),s.length==1?Z(t):s.length==3&&(R=(s[2].clientX+s[1].clientX+s[0].clientX)/2,E=(s[2].clientY+s[1].clientY+s[0].clientY)/2)}function et(t){for(let e=0;e<s.length;e++)if(t.pointerId==s[e].pointerId){s[e]=t;break}if(s.length==1)Q();else if(s.length==3){const e=(s[2].clientX+s[1].clientX+s[0].clientX)/2,n=(s[2].clientY+s[1].clientY+s[0].clientY)/2,a=e-R,u=n-E;_.rotation.y-=a*.001,_.rotation.x-=u*.001,f()}else if(s.length==2){const e=Math.sqrt(Math.pow(s[1].clientX-s[0].clientX,2)+Math.pow(s[1].clientY-s[0].clientY,2));d>0&&(_.scaling.y+=(e-d)*.01,_.scaling.x+=(e-d)*.01,_.scaling.z+=(e-d)*.01),f(),d=e}}function y(t){nt(t),s.length<3&&(d=-1),s.length==1&&$()}function nt(t){for(let e=0;e<s.length;e++)if(s[e].pointerId==t.pointerId){s.splice(e,1);break}}function at(){c.onpointerdown=tt,c.onpointermove=et,c.onpointerup=y,c.onpointercancel=y,c.onpointerout=y,c.onpointerleave=y}async function rt(){o=await async function(){try{return P()}catch{return console.log("the available createEngine function failed. Creating the default engine instead"),P()}}(),o.loadingScreen=j,o.displayLoadingUI(),l=W(),l.autoClearDepthAndStencil=!0,l.clearColor=new V(0,0,0,0)}rt().then(()=>{m=l,v=new k(c),z.init()});window.addEventListener("resize",function(){o==null||o.resize(),A()});
