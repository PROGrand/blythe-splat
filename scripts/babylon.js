"use strict";require("./modulepreload-polyfill.js");const e=require("./babylonjs.js"),n=require("./fullscreen.js");e.RegisterSceneLoaderPlugin({...e.GLTFFileLoaderMetadata,createPlugin:async n=>{const{GLTFFileLoader:t}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.glTFLoader));return new t(n[e.GLTFFileLoaderMetadata.name])}}),e.registerGLTFExtension("EXT_lights_image_based",!0,(async e=>{const{EXT_lights_image_based:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_lights_image_based));return new n(e)})),e.registerGLTFExtension("EXT_mesh_gpu_instancing",!0,(async e=>{const{EXT_mesh_gpu_instancing:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_mesh_gpu_instancing));return new n(e)})),e.registerGLTFExtension("EXT_meshopt_compression",!0,(async e=>{const{EXT_meshopt_compression:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_meshopt_compression));return new n(e)})),e.registerGLTFExtension("EXT_texture_avif",!0,(async e=>{const{EXT_texture_avif:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_texture_avif));return new n(e)})),e.registerGLTFExtension("EXT_texture_webp",!0,(async e=>{const{EXT_texture_webp:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_texture_webp));return new n(e)})),e.registerGLTFExtension("ExtrasAsMetadata",!1,(async e=>{const{ExtrasAsMetadata:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.ExtrasAsMetadata));return new n(e)})),e.registerGLTFExtension("KHR_animation_pointer",!0,(async e=>{const{KHR_animation_pointer:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_animation_pointer));return new n(e)})),e.registerGLTFExtension("KHR_draco_mesh_compression",!0,(async e=>{const{KHR_draco_mesh_compression:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_draco_mesh_compression));return new n(e)})),e.registerGLTFExtension("KHR_interactivity",!0,(async e=>{const{KHR_interactivity:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_interactivity));return new n(e)})),e.registerGLTFExtension("KHR_lights_punctual",!0,(async e=>{const{KHR_lights:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_lights_punctual));return new n(e)})),e.registerGLTFExtension("EXT_lights_ies",!0,(async e=>{const{EXT_lights_ies:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.EXT_lights_ies));return new n(e)})),e.registerGLTFExtension("KHR_materials_anisotropy",!0,(async e=>{const{KHR_materials_anisotropy:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_anisotropy));return new n(e)})),e.registerGLTFExtension("KHR_materials_clearcoat",!0,(async e=>{const{KHR_materials_clearcoat:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_clearcoat));return new n(e)})),e.registerGLTFExtension("KHR_materials_diffuse_transmission",!0,(async e=>{const{KHR_materials_diffuse_transmission:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_diffuse_transmission));return new n(e)})),e.registerGLTFExtension("KHR_materials_dispersion",!0,(async e=>{const{KHR_materials_dispersion:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_dispersion));return new n(e)})),e.registerGLTFExtension("KHR_materials_emissive_strength",!0,(async e=>{const{KHR_materials_emissive_strength:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_emissive_strength));return new n(e)})),e.registerGLTFExtension("KHR_materials_ior",!0,(async e=>{const{KHR_materials_ior:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_ior));return new n(e)})),e.registerGLTFExtension("KHR_materials_iridescence",!0,(async e=>{const{KHR_materials_iridescence:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_iridescence));return new n(e)})),e.registerGLTFExtension("KHR_materials_pbrSpecularGlossiness",!0,(async e=>{const{KHR_materials_pbrSpecularGlossiness:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_pbrSpecularGlossiness));return new n(e)})),e.registerGLTFExtension("KHR_materials_sheen",!0,(async e=>{const{KHR_materials_sheen:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_sheen));return new n(e)})),e.registerGLTFExtension("KHR_materials_specular",!0,(async e=>{const{KHR_materials_specular:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_specular));return new n(e)})),e.registerGLTFExtension("KHR_materials_transmission",!0,(async e=>{const{KHR_materials_transmission:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_transmission));return new n(e)})),e.registerGLTFExtension("KHR_materials_unlit",!0,(async e=>{const{KHR_materials_unlit:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_unlit));return new n(e)})),e.registerGLTFExtension("KHR_materials_variants",!0,(async e=>{const{KHR_materials_variants:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_variants));return new n(e)})),e.registerGLTFExtension("KHR_materials_volume",!0,(async e=>{const{KHR_materials_volume:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_materials_volume));return new n(e)})),e.registerGLTFExtension("KHR_mesh_quantization",!0,(async e=>{const{KHR_mesh_quantization:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_mesh_quantization));return new n(e)})),e.registerGLTFExtension("KHR_texture_basisu",!0,(async e=>{const{KHR_texture_basisu:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_texture_basisu));return new n(e)})),e.registerGLTFExtension("KHR_texture_transform",!0,(async e=>{const{KHR_texture_transform:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_texture_transform));return new n(e)})),e.registerGLTFExtension("KHR_xmp_json_ld",!0,(async e=>{const{KHR_xmp_json_ld:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_xmp_json_ld));return new n(e)})),e.registerGLTFExtension("MSFT_audio_emitter",!0,(async e=>{const{MSFT_audio_emitter:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.MSFT_audio_emitter));return new n(e)})),e.registerGLTFExtension("MSFT_lod",!0,(async e=>{const{MSFT_lod:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.MSFT_lod));return new n(e)})),e.registerGLTFExtension("MSFT_minecraftMesh",!0,(async e=>{const{MSFT_minecraftMesh:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.MSFT_minecraftMesh));return new n(e)})),e.registerGLTFExtension("MSFT_sRGBFactors",!0,(async e=>{const{MSFT_sRGBFactors:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.MSFT_sRGBFactors));return new n(e)})),e.registerGLTFExtension("KHR_node_visibility",!0,(async e=>{const{KHR_node_visibility:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_node_visibility));return new n(e)})),e.registerGLTFExtension("KHR_node_hoverability",!0,(async e=>{const{KHR_node_hoverability:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_node_hoverability));return new n(e)})),e.registerGLTFExtension("KHR_node_selectability",!0,(async e=>{const{KHR_node_selectability:n}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.KHR_node_selectability));return new n(e)})),e.RegisterSceneLoaderPlugin({...e.OBJFileLoaderMetadata,createPlugin:async n=>{const{OBJFileLoader:t}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.objFileLoader));return new t(n[e.OBJFileLoaderMetadata.name])}}),e.RegisterSceneLoaderPlugin({...e.SPLATFileLoaderMetadata,createPlugin:async n=>{const{SPLATFileLoader:t}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.splatFileLoader));return new t(n[e.SPLATFileLoaderMetadata.name])}}),e.RegisterSceneLoaderPlugin({...e.STLFileLoaderMetadata,createPlugin:async()=>{const{STLFileLoader:e}=await Promise.resolve().then((()=>require("./babylonjs.js"))).then((e=>e.stlFileLoader));return new e}});let t=null,s=null;const r=document.getElementById("renderCanvas");let i,a=null,o=null,l=null,c=null;function _(){null==a||a.stopRenderLoop(),null!=c&&cancelAnimationFrame(c),c=requestAnimationFrame((()=>{null!=l&&l.activeCamera&&l.render(!1,!0)}))}const u=new e.DefaultLoadingScreen(r,"Loading","black"),m=()=>new e.Engine(r,!1,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1});function h(){null!=l&&l.activeCamera&&l.render(!1,!0)}let b;const d=function(){const n=new e.Scene(a);new e.ArcRotateCamera("Camera",-Math.PI/2,Math.PI/2,10,new e.Vector3(0,0,0),n).useFramingBehavior=!0,e.ImportMeshAsync(document.getElementById("splat_url").value,n).then((r=>{i=r.meshes[0],null==a||a.hideLoadingUI(),i.position.set(0,0,-3),i.scaling.set(1,1,1),i.rotation.set(0,0,0),s=new e.HtmlElementTexture("vt",null==t?void 0:t.videoCanvas,{scene:n,engine:a,samplingMode:e.Constants.TEXTURE_BILINEAR_SAMPLINGMODE,generateMipMaps:!1}),window.setInterval((()=>{null==s||s.update(),n.render()}),50),b=e.MeshBuilder.CreatePlane("plane",{width:1,height:1},n),b.billboardMode=e.AbstractMesh.BILLBOARDMODE_ALL;const o=new e.StandardMaterial("RTT material",n);o.transparencyMode=3,o.alphaMode=e.Constants.ALPHA_COMBINE,o.emissiveTexture=s,o.disableLighting=!0,b.material=o,g(),null==a||a.runRenderLoop(h)}));const o=document.getElementById("screenshotBtn");return null!=o&&o.addEventListener("click",(async()=>{i&&await async function(e){e.render(!1,!0),r.toBlob((e=>{const n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="splat.png",n.click(),console.log("Success! Saved cropped splat as splat.png")}),"image/png",1)}(n)})),n.onDispose=function(){r.onpointerdown=null,r.onpointermove=null,r.onpointerup=null,r.onpointercancel=null,r.onpointerout=null,r.onpointerleave=null},r.onpointerdown=v,r.onpointermove=L,r.onpointerup=T,r.onpointercancel=T,r.onpointerout=T,r.onpointerleave=T,n};function g(){const e=null==l?void 0:l.activeCamera,n=e.fov,t=a.getAspectRatio(e),s=2*e.position.length()*Math.tan(n/2),r=s*t;b.scaling.set(r,s,1)}let y=3,w=0,p=0;let R=[],j=-1;function v(e){R.push(e),1==R.length?function(e){switch(w=o.pointerX,p=o.pointerY,e.button){case 0:y=0;break;case 1:y=1;break;case 2:y=2}}(e):3==R.length&&(w=(R[2].clientX+R[1].clientX+R[0].clientX)/2,p=(R[2].clientY+R[1].clientY+R[0].clientY)/2)}function L(e){for(let n=0;n<R.length;n++)if(e.pointerId==R[n].pointerId){R[n]=e;break}if(1==R.length)!function(){const e=o.pointerX-w,n=o.pointerY-p;switch(y){case 0:i.position.x-=.01*-e,i.position.y-=.01*n;break;case 2:i.rotation.y-=.01*e,i.rotation.x-=.01*n;break;case 1:i.scaling.y-=.01*n,i.scaling.x-=.01*n,i.scaling.z-=.01*n}w=o.pointerX,p=o.pointerY,_()}();else if(3==R.length){const e=(R[2].clientX+R[1].clientX+R[0].clientX)/2,n=(R[2].clientY+R[1].clientY+R[0].clientY)/2,t=e-w,s=n-p;i.rotation.y-=.001*t,i.rotation.x-=.001*s,_()}else if(2==R.length){const e=Math.sqrt(Math.pow(R[1].clientX-R[0].clientX,2)+Math.pow(R[1].clientY-R[0].clientY,2));j>0&&(i.scaling.y+=.01*(e-j),i.scaling.x+=.01*(e-j),i.scaling.z+=.01*(e-j)),_(),j=e}}function T(e){!function(e){for(let n=0;n<R.length;n++)if(R[n].pointerId==e.pointerId){R.splice(n,1);break}}(e),R.length<3&&(j=-1),1==R.length&&(y=3)}(async function(){a=await async function(){try{return m()}catch(e){return console.log("the available createEngine function failed. Creating the default engine instead"),m()}}(),a.loadingScreen=u,a.displayLoadingUI(),o=d(),o.autoClearDepthAndStencil=!0,o.clearColor=new e.Color4(0,0,0,0)})().then((()=>{l=o,t=new n.VideoEngine(r),n.FullscreenEngine.init()})),window.addEventListener("resize",(function(){null==a||a.resize(),g()}));
